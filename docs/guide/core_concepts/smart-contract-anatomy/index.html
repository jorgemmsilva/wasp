<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">Anatomy of a Smart Contract | IOTA Smart Contract Protocol</title><meta data-react-helmet="true" property="og:url" content="https://iscp.docs.iota.org/docs/guide/core_concepts/smart-contract-anatomy/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Anatomy of a Smart Contract | IOTA Smart Contract Protocol"><meta data-react-helmet="true" name="description" content="Smart contracts are programs, immutably stored in the chain."><meta data-react-helmet="true" property="og:description" content="Smart contracts are programs, immutably stored in the chain."><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://iscp.docs.iota.org/docs/guide/core_concepts/smart-contract-anatomy/"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/core_concepts/smart-contract-anatomy/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://iscp.docs.iota.org/docs/guide/core_concepts/smart-contract-anatomy/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.613afa96.css">
<link rel="preload" href="/assets/js/runtime~main.a3f085e8.js" as="script">
<link rel="preload" href="/assets/js/main.e9158874.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo/WASP_logo_dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">ISCP</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/overview/">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview/">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Core Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/smart-contracts/">Smart Contracts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/iscp/">ISCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/iscp-architecture/">ISCP Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/validators/">Committees and Validators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/consensus/">Consensus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/states/">State, Transitions and State Anchoring</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/guide/core_concepts/smart-contract-anatomy/">Anatomy of a Smart Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/core_concepts/sandbox/">Sandbox Interface</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Core Contracts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Accounts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Interacting With Smart Contracts</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Types of VMs/Languages</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Solo</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ISCP Chains and Nodes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Rust/WASM</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">EVM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/contribute/">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Old</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Anatomy of a Smart Contract</h1></header><p>Smart contracts are programs, immutably stored in the chain.</p><p>The logical structure of an ISCP smart contract is independent of the VM type we
use, be it a <em>Wasm</em> smart contract or any other VM type.</p><p><img alt="Smart Contract Structure" src="/assets/images/SC-structure-95a09ea794362efb20ff6a4d06627285.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="identifying-a-smart-contract"></a>Identifying a Smart Contract<a class="hash-link" href="#identifying-a-smart-contract" title="Direct link to heading">#</a></h2><p>Each smart contract on the chain is identified by its name hashed into 4 bytes
and interpreted as <code>uint32</code> value: the <code>hname</code>.</p><p>For example, the <code>hname</code> of the root contract is <code>0xcebf5908</code>, the unique identifier of the
<code>root</code> contract in every chain. The exception is <code>_default</code> contract which always has hname <code>0x00000000</code>.</p><p>Each smart contract instance has a program with a collection of entry points and
a state. An entry point is a function of the program through which the program
can be invoked.</p><p>There are several ways to invoke an entry point: a request, a call and a view
call, depending on the type of the entry point.</p><p>The smart contract program can access its state and account through an interface
layer called the <em>Sandbox</em>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="state"></a>State<a class="hash-link" href="#state" title="Direct link to heading">#</a></h2><p>The smart contract state is its data, with each update stored on the chain. The
state can only be modified by the smart contract program itself. There are two
parts of the state:</p><ul><li>A collection of key/value pairs called the <code>data state</code>. Each key and value
are byte arrays of arbitrary size (there are practical limits set by the
database, of course). The value of the key/value pair is always retrieved by
its key.</li><li>A collection of <code>color: balance</code> pairs called the <code>account</code>. The account
represents the balances of tokens of specific colors controlled by the smart
contract. Receiving and spending tokens into/from the account means changing
the account&#x27;s balances.</li></ul><p>Only the smart contract program can change its data state and spend from its
account. Tokens can be sent to the smart contract account by any other agent on
the ledger, be it a wallet with an address or another smart contract.</p><p>See <a href="/docs/guide/core_concepts/accounts/how-accounts-work/">Accounts</a> for more info on sending and receiving tokens.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="entry-points"></a>Entry points<a class="hash-link" href="#entry-points" title="Direct link to heading">#</a></h2><p>There are two types of entry points:</p><ul><li><em>Full entry points</em> or just <em>entry points</em>. These functions can modify
(mutate) the state of the smart contract.</li><li><em>View entry points</em> or <em>views</em>. These are read-only functions. They are used
only to retrieve the information from the smart contract state. They canâ€™t
modify the state, i.e. are read-only calls.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="execution-results"></a>Execution Results<a class="hash-link" href="#execution-results" title="Direct link to heading">#</a></h2><p>After a request to a Smart Contract is executed (a call to a &quot;full entry point&quot;),
There will be a <code>receipt</code> added to the <a href="/docs/guide/core_concepts/core_contracts/blocklog/"><code>BlockLog</code></a>
detailing the execution results of said request: whether it was successful, the block it was
included in, and other information. Any events dispatched by the Smart Contract in context of
this execution will also be added to the BlockLog.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="error-handling"></a>Error Handling<a class="hash-link" href="#error-handling" title="Direct link to heading">#</a></h2><p>When a smart contract execution is interrupted for some reason (exception), or it produces an
error (missing parameter, or other inconsistency), the funds will be refunded to the caller,
except the fees. Any error that resulted from the SC execution can be viewed on the contract
<code>receipt</code> (present in the <a href="/docs/guide/core_concepts/core_contracts/blocklog/"><code>BlockLog</code></a>).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/chronicle.rs/tree/main/docs/docs/guide/core_concepts/smart-contract-anatomy.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guide/core_concepts/states/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« State, Transitions and State Anchoring</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/guide/core_concepts/sandbox/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">sandbox Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#identifying-a-smart-contract" class="table-of-contents__link">Identifying a Smart Contract</a></li><li><a href="#state" class="table-of-contents__link">State</a></li><li><a href="#entry-points" class="table-of-contents__link">Entry points</a></li><li><a href="#execution-results" class="table-of-contents__link">Execution Results</a></li><li><a href="#error-handling" class="table-of-contents__link">Error Handling</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview/">Overview</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a3f085e8.js"></script>
<script src="/assets/js/main.e9158874.js"></script>
</body>
</html>